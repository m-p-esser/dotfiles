!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("highcharts"),require("@finos/perspective/dist/esm/config"),require("core-js/modules/web.dom.iterable"),require("core-js/modules/es6.regexp.split"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.symbol"),require("highcharts-more"),require("highcharts/modules/heatmap"),require("highcharts/modules/boost"),require("highcharts/modules/treemap"),require("highcharts/modules/sunburst"),require("highcharts-grouped-categories"),require("gradient-parser"),require("@finos/perspective-viewer/dist/esm/utils"),require("detectie"),require("core-js/modules/es6.regexp.replace")):"function"==typeof define&&define.amd?define(["highcharts","@finos/perspective/dist/esm/config","core-js/modules/web.dom.iterable","core-js/modules/es6.regexp.split","core-js/modules/es7.symbol.async-iterator","core-js/modules/es6.symbol","highcharts-more","highcharts/modules/heatmap","highcharts/modules/boost","highcharts/modules/treemap","highcharts/modules/sunburst","highcharts-grouped-categories","gradient-parser","@finos/perspective-viewer/dist/esm/utils","detectie","core-js/modules/es6.regexp.replace"],t):"object"==typeof exports?exports["perspective-viewer-highcharts"]=t(require("highcharts"),require("@finos/perspective/dist/esm/config"),require("core-js/modules/web.dom.iterable"),require("core-js/modules/es6.regexp.split"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.symbol"),require("highcharts-more"),require("highcharts/modules/heatmap"),require("highcharts/modules/boost"),require("highcharts/modules/treemap"),require("highcharts/modules/sunburst"),require("highcharts-grouped-categories"),require("gradient-parser"),require("@finos/perspective-viewer/dist/esm/utils"),require("detectie"),require("core-js/modules/es6.regexp.replace")):e["perspective-viewer-highcharts"]=t(e.highcharts,e["@finos/perspective/dist/esm/config"],e["core-js/modules/web.dom.iterable"],e["core-js/modules/es6.regexp.split"],e["core-js/modules/es7.symbol.async-iterator"],e["core-js/modules/es6.symbol"],e["highcharts-more"],e["highcharts/modules/heatmap"],e["highcharts/modules/boost"],e["highcharts/modules/treemap"],e["highcharts/modules/sunburst"],e["highcharts-grouped-categories"],e["gradient-parser"],e["@finos/perspective-viewer/dist/esm/utils"],e.detectie,e["core-js/modules/es6.regexp.replace"])}(window,(function(e,t,s,i,n,o,r,a,l,c,h,u,d,p,f,m){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=19)}([function(e,t,s){"use strict";s(3),s(5),s(6);var i=s(1),n=s.n(i),o=s(8),r=s.n(o),a=s(9),l=s.n(a),c=s(10),h=s.n(c),u=s(11),d=s.n(u),p=s(12),f=s.n(p),m=s(13),g=s.n(m),b=s(14),_=s.n(b),y=s(15),x=s.n(y);const v=n.a;let O=v.Axis.prototype,j=O.render;h()(n.a),d()(n.a),g()(n.a),_()(n.a),x()(n.a),f()(n.a);const w=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],k=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];v.setOptions({colors:k}),function(e){e.wrap(e.seriesTypes.scatter.prototype,"translate",(function(e){e.apply(this,Array.prototype.slice.call(arguments,1)),"colored"===this.chart.userOptions.chart.type.slice(0,7)&&this.translateColors.call(this)}));var t=e.seriesTypes,s=e.merge,i=e.extendClass,n=e.getOptions().plotOptions,o={optionalAxis:"colorAxis",colorKey:"colorValue",translateColors:t.heatmap&&t.heatmap.prototype.translateColors};n.coloredColumn=s(n.column,{}),t.coloredColumn=i(t.column,s(o,{type:"coloredColumn",axisTypes:["xAxis","yAxis","colorAxis"]})),n.coloredScatter=s(n.scatter,{}),t.coloredScatter=i(t.scatter,s(o,{type:"coloredScatter",axisTypes:["xAxis","yAxis","colorAxis"]})),n.coloredBubble=s(n.bubble,{}),t.coloredBubble=i(t.bubble,s(o,{type:"coloredBubble",axisTypes:["xAxis","yAxis","colorAxis"]})),e.wrap(e.seriesTypes.sunburst.prototype,"translate",(function(e,t){e.call(this,t),this.translateColors()})),e.seriesTypes.sunburst.prototype.translateColors=function(){var t=this,s=this.options.nullColor,i=this.colorAxis,n=this.colorKey;e.each(this.data,(function(e){var o,r=e[n];(o=e.options.color||(e.value?i&&void 0!==r?i.toColor(r,e):e.color||t.color:s))&&(e.color=o)}))},e.seriesTypes.sunburst.prototype.colorKey="colorValue",O.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),void 0===this.originalTickLength&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,j.call(this),!this.isGrouped)return this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}),!1;var e=this,t=e.options,s=e.hasVisibleSeries||e.hasData,i=e.labelsGrid,n=e.labelsGridPath,o=e.tickWidth;return i||(i=e.labelsGrid=e.chart.renderer.path().attr({strokeWidth:o,"stroke-width":o,stroke:t.tickColor||""}).add(e.axisGroup),t.tickColor||i.addClass("highcharts-tick")),i.attr({d:n,visibility:s?"visible":"hidden"}),e.labelGroup.attr({visibility:s?"visible":"hidden"}),function e(t,s,i){for(var n,o=t.length;o--;)(n=t[o][s])&&e(n,s,i),i(t[o])}(e.categoriesTree,"categories",(function(t){var i=t.tick;return!!i&&(i.startAt+i.leaves-1<e.min||i.startAt>e.max?(i.label.hide(),i.destroyed=0):i.label.attr({visibility:s?"visible":"hidden"}),!0)})),!0}}(v);var A=s(16);function T(e){let t;t=window.ShadyCSS?window.ShadyCSS.getComputedStyleValue(this,"--highcharts-".concat(e,"--gradient")):getComputedStyle(this).getPropertyValue("--highcharts-".concat(e,"--gradient"));const s=A.parse(t)[0].colorStops;return s.map((e,t)=>{let i;return i="rgb"===e.type?"rgb(".concat(e.value.join(","),")"):"#".concat(e.value),[Number.parseFloat(e.length?e.length.value/100:"".concat(t/(s.length-1))),i]})}const S=(()=>{let e;return function(t){if(t||void 0===e){e={};for(let t of["positive","negative","full"])e[t]=T.bind(this)(t)}return e}})();function C(e,t,s){let i,{positive:n,negative:o,full:r}=S.bind(this)(s);i=t[0]>=0?n:t[1]<=0?o:r,Object.assign(e,{colorAxis:{min:t[0],max:t[1],stops:i,reversed:!1,startOnTick:!1,endOnTick:!1}}),e.legend.reversed=!0,e.legend.floating=!1,e.legend.enabled=!0}s(4);const M="|";function q(e,t,s){let i,n=0;for(;n<e.length;n++){let o=void 0===s||e[n].stack===s;if(e[n].name==t&&o){i=e[n];break}}return n==e.length&&(i={name:t,connectNulls:!0,data:[]},s&&(i.stack=s),e.push(i)),i}function P(e,t,s){let i={name:t,connectNulls:!0,data:e};return s&&(i.stack=s),i}function z(e){return null===e?"-":e}class W{constructor(e,t){this.depth=e,this.json=t,this.top={name:"",depth:0,categories:[]}}add_label(e){let t={name:e[e.length-1],depth:e.length,categories:[]};for(var s=this.top,i=0;i<e.length-1;i++)for(var n=0;n<s.categories.length;n++)if(s.categories[n].name===e[i]){s=s.categories[n];break}return s.categories.push(t),t}*[Symbol.iterator](){let e=this.top;for(let t of this.json){let s=t.__ROW_PATH__||[""];s.length>0&&s.length<this.depth?e=this.add_label(s):s.length>=this.depth&&(e.categories.push(z(s[s.length-1])),yield t)}}}class L{constructor(e,t){this.columns=e,this.depth=t,this.axis={name:"",depth:0,categories:[]},this.fill_axis()}add_label(e){let t={name:e[e.length-1],depth:e.length,categories:[]};for(var s=this.axis,i=0;i<e.length-1;i++)for(var n=0;n<s.categories.length;n++)if(s.categories[n].name===e[i]){s=s.categories[n];break}return s.categories.push(t),t}fill_axis(){let e=this.axis;if(void 0!==this.columns.__ROW_PATH__)for(let t of this.columns.__ROW_PATH__)if(t.length>0&&t.length<this.depth)e=this.add_label(t);else if(t.length>=this.depth){e.categories.push(z(t[t.length-1]));continue}}}class R{constructor(e){this.rows=e}*[Symbol.iterator](){for(let e of this.rows)void 0===this.columns&&(this.columns=Object.keys(e).filter(e=>"__ROW_PATH__"!==e),this.is_stacked=this.columns.map(e=>e.substr(e.lastIndexOf(M)+1,e.length)).filter((e,t,s)=>s.indexOf(e)===t).length>1),yield e}}class H{constructor(e,t){this.columns=e,this.column_names=Object.keys(this.columns).filter(e=>"__ROW_PATH__"!==e),this.is_stacked=this.column_names.map(e=>e.substr(e.lastIndexOf(M)+1,e.length)).filter((e,t,s)=>s.indexOf(e)===t).length>1,this.pivot_length=t}*[Symbol.iterator](){for(let e of this.column_names){let t=this.columns[e];if(this.columns.__ROW_PATH__){let e=[];for(let s=0;s<t.length;s++)this.columns.__ROW_PATH__[s].length===this.pivot_length&&e.push(t[s]);t=e}yield{name:e,data:t}}}}class N{constructor(e){this.dict={},this.names=[],this.type=e}clean(e){return"string"===this.type?(e in this.dict||(this.dict[e]=Object.keys(this.dict).length,this.names.push(z(e))),this.dict[e]):void 0===e||""===e||isNaN(e)?null:e}}class V{constructor(e,t){this.schema=e,this.xaxis_clean=new N(e[t[0]]),this.yaxis_clean=new N(e[t[1]]),this.color_clean=new N(e[t[2]])}make(e,t,s){let i={};if(i.x=e[t[0]],null!==i.x||null!==e[t[1]]){if(i.x=this.xaxis_clean.clean(i.x),i.y=0,t.length>1&&(i.y=e[t[1]],i.y=this.yaxis_clean.clean(i.y)),t.length>2){let n=e[t[2]];if("string"===this.schema[t[2]]){let e=this.color_clean.clean(n);i.marker={lineColor:e,fillColor:e}}else isNaN(n)||(s[0]=Math.min(s[0],n),s[1]=Math.max(s[1],n)),i.colorValue=n}return t.length>3&&(i.z=isNaN(e[t[3]])?1:e[t[3]]),"__ROW_PATH__"in e&&(i.name=e.__ROW_PATH__.join(", ")),i}}make_col(e,t,s,i,n,o){let r=[],a=e;if(0===e.length)return r;if(void 0===e.length){a=[];for(let s of t)a.push(e[s])}for(let e=0;e<a[0].length;e++){if(null===a[0][e]||void 0===a[0][e]||""===a[0][e])continue;let l={};if(n){if(n[e].length!==i)continue;l.name=n[e].join(", ")}if(l.x=this.xaxis_clean.clean(a[0][e]),s>1&&(l.y=this.yaxis_clean.clean(a[1][e])),s>2){let s=a[2][e];if("string"===this.schema[t[2]]){let e=this.color_clean.clean(s);l.marker={lineColor:e,fillColor:e}}else isNaN(s)||(o[0]=Math.min(o[0],s),o[1]=Math.max(o[1],s)),l.colorValue=s}if(s>3){let t=a[3][e];l.z=isNaN(t)?1:t}r.push(l)}return r}}function G(e,t,s,i,n){const o=new H(e,i.length);let r=[],a=[1/0,-1/0],l=new V(t,o.column_names),c=o.columns.__ROW_PATH__;if(0===n.length){let e=P(l.make_col(o.columns,o.column_names,s.length,o.pivot_length,c,a)," ");r.push(e)}else{let e={};if(c){let e=[];for(let t=0;t<c.length;t++)c[t].length===o.pivot_length&&e.push(c[t]);c=e}for(let t of o){let i=t.name.split(M),n=i.slice(0,i.length-1).join(", ")||" ";if(void 0===e[n]&&(e[n]=[]),e[n].push(t.data),e[n].length===s.length){let t=P(l.make_col(e[n],s,s.length,o.pivot_length,c,a),n);r.push(t)}}}return[r,{categories:l.xaxis_clean.names},a,{categories:l.yaxis_clean.names}]}function Y(e,t,s){let[i,n]=function(e,t){let s=new W(t.length,e),i=new R(s);var n=[];for(let e of i)for(let t of i.columns){let s=t.split(M),o=s[s.length-1];s=i.is_stacked?s.join(", ")||o:s.slice(0,s.length-1).join(", ")||" ";let r=q(n,s,o),a=e[t];a=void 0===a||""===a?null:a,r.data.push(a)}return[n,s.top]}(e,t);"string"!==s&&void 0!==s&&(i=i.reverse());let o=[1/0,-1/0],r=function(e){let t=e.map(e=>e.name.split(",")),s={name:null,depth:0,categories:[]},i=t[0].length;for(let e=0;e<t.length;++e){let n=t[e],o=s;for(let e=0;e<n.length;++e){let t=n[e];if(e===i-1)o.categories.push(t);else{let s=o.categories.length;if(s>0&&o.categories[s-1].name==t)o=o.categories[s-1];else{let s={name:t,depth:e+1,categories:[]};o.categories.push(s),o=s}}}}return s}(i),a=[];for(let e=0;e<i[0].data.length;++e)for(let t=0;t<i.length;++t){let s=i[t].data[e];a.push([e,t,s]),o[0]=Math.min(o[0],s),o[1]=Math.max(o[1],s)}if(o[0]*o[1]<0){let e=Math.max(Math.abs(o[0]),Math.abs(o[1]));o=[-e,e]}return i=a,[i,n,r,o]}class E extends W{*[Symbol.iterator](){let e=this.top;for(let t of this.json){let s=t.__ROW_PATH__||[""];s.length>0&&s.length<this.depth?e=this.add_label(s):s.length>=this.depth&&e.categories.push(z(s[s.length-1])),yield t}}}function D(e,t,s,i){let n=new E(t.length,e),o=new R(n),r=[];for(let e of o){let i=e.__ROW_PATH__.map(e=>null===e?"-":e),n=i.join(", "),a=i.slice(-1)[0],l=i.slice(0,-1).join(", ");for(let i=0;i<o.columns.length;i++){let c=o.columns[i],h=c.split(M),u=h[h.length-1];if(h=h.slice(0,h.length-1).join(", ")||" ",i%s.length==0){q(r,h,u).data.push({id:n,name:a,value:e[c],colorValue:s.length>1?e[o.columns[i+1]]:void 0,parent:l,leaf:e.__ROW_PATH__.length===t.length})}}}let a=function(e,t){let s=[];for(let i of e){let e=i.name.split(M);s.push({layoutAlgorithm:"squarified",allowDrillToNode:!0,alternateStartingDirection:!0,data:i.data.slice(1),levels:t,title:e,stack:i.stack})}return s}(r,function(e){let t=[];for(let s=0;s<e.length;s++)t.push({level:s+1,borderWidth:2*(e.length-s),dataLabels:{enabled:!0,allowOverlap:!0,style:{opacity:[1,.3][s]||0,fontSize:"".concat([14,10][s]||0,"px"),textOutline:null}}});return t}(t)),l=function(e,t,s){let i;if(e.length>=2){i=[1/0,-1/0];for(let e of t){let t=e.data;for(let e=1;e<t.length;++e)(s&&t[e].leaf||!s)&&(i[0]=Math.min(i[0],t[e].colorValue),i[1]=Math.max(i[1],t[e].colorValue));if(i[0]*i[1]<0){let e=Math.max(Math.abs(i[0]),Math.abs(i[1]));i=[-e,e]}}}return i}(s,r,i);return[a,n.top,l]}s(22);var F=s(2);function X(e,t,s){const i=J(t,U(e,s));return"NaN"===i||null==i?"":"<span>".concat(e,": <b>").concat(i,"</b></span><br/>")}function B(e,t){if(t.length<=0)return"";let s=[];for(let i=0;i<e.length;i++)s.push("<span>".concat(e[i],": <b>").concat(t[i],"</b></span><br/>"));return s.join("")}function I(e){let t=[],s=e.parent;for(t.unshift(e.name);void 0!==s;)void 0!==s.name&&t.unshift(s.name),s=s.parent;return t}function U(e,t){return t[e]}function K(e){return void 0!==e&&" "!==e}function J(e,t){return"datetime"===t?new Date(e).toLocaleString("en-us",Object(F.get_type_config)("datetime").format):"date"===t?new Date(e).toLocaleString("en-us",Object(F.get_type_config)("date").format):"float"===t||"integer"===t?(s=e,"float"===t?Number.parseFloat(s).toLocaleString(Object(F.get_type_config)("float").format):Number.parseInt(s).toLocaleString(Object(F.get_type_config)("float").format)):e;var s}function Z(e,t,...s){if((e.series[0].data?e.series[0].data.length*e.series.length:e.series.length)>5e3)return Object.assign(e,{boost:{useGPUTranslations:-1===s.indexOf("datetime")&&-1===s.indexOf("date"),usePreAllocated:-1===s.indexOf("datetime")&&-1===s.indexOf("date")}}),e.plotOptions.series.boostThreshold=1,e.plotOptions.series.turboThreshold=0,!0}function Q(e){let t=Math.min(6,Math.max(3,Math.floor((this.clientWidth+this.clientHeight)/Math.max(300,e.series[0].data.length/3))));e.plotOptions.coloredScatter={marker:{radius:t}},e.plotOptions.scatter={marker:{radius:t}}}function $(e,t,s,i,n,o){"string"===i?ee(e,t,n,o):function(e,t,s,i){let n={type:["datetime","date"].indexOf(i)>-1?"datetime":void 0,startOnTick:!1,endOnTick:!1,title:{style:{color:"#666666",fontSize:"14px"},text:s}};"yAxis"===t&&Object.assign(n,{labels:{overflow:"justify"}});Object.assign(e,{[t]:n})}(e,t,s,i)}function ee(e,t,s,i){if("datetime"===s)Object.assign(e,{[t]:{categories:i.categories.map(e=>new Date(e).toLocaleString("en-us",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})),labels:{enabled:i.categories.length>0,autoRotation:[-5]}}});else if("date"===s)Object.assign(e,{[t]:{categories:i.categories.map(e=>new Date(e).toLocaleString("en-us",{year:"numeric",month:"numeric",day:"numeric"})),labels:{enabled:i.categories.length>0,autoRotation:[-5]}}});else{let s={categories:i.categories,labels:{enabled:i.categories.length>0,padding:0,autoRotation:[-10,-20,-30,-40,-50,-60,-70,-80,-90]}};"yAxis"!==t||e.hasOwnProperty("boost")&&"heatmap"!==e.chart.type||Object.assign(s,{title:null,tickWidth:1,reversed:!0}),Object.assign(e,{[t]:s})}}function te(e,t){let s="scatter",i="xy";"y_line"===t?(i="y",s="line"):"y_area"===t?(i="y",s="area"):"y_scatter"===t?(i="y",s="scatter"):t.indexOf("bar")>-1?(i="y",s="column"):"treemap"==t?(i="hierarchy",s="treemap"):"sunburst"==t?(i="hierarchy",s="sunburst"):"scatter"===t?(i="xy",s=e.length<=3?"scatter":"bubble"):"heatmap"===t&&(i="xyz",s="heatmap");const n=this,o=this._config,r=(a=o.aggregates,Object.keys(a));var a;const l=(c=o.row_pivots,h=o.column_pivots,{row:c,column:h});var c,h;return{chart:{type:s,inverted:"x_"===t.slice(0,2),animation:!1,zoomType:"scatter"===t?"xy":"x",resetZoomButton:{position:{align:"left"}}},navigation:{buttonOptions:{enabled:!1}},credits:{enabled:!1},title:{text:null},legend:{align:"right",verticalAlign:"top",y:10,layout:"vertical",enabled:!1,itemStyle:{fontWeight:"normal"}},boost:{enabled:!1},plotOptions:{area:{stacking:"normal",marker:{enabled:!1,radius:0}},line:{marker:{enabled:!1,radius:0}},coloredScatter:{},scatter:{},column:{stacking:"normal",states:{hover:{brightness:-.1,borderColor:"#000000"}}},heatmap:{nullColor:"rgba(0,0,0,0)"},series:{animation:!1,nullColor:"rgba(0,0,0,0)",boostThreshold:0,turboThreshold:6e4,borderWidth:0,connectNulls:!0,lineWidth:-1===t.indexOf("line")?0:1.5,states:{hover:{lineWidthPlus:0}},point:{events:{click:async function(){let e=[],i=[];if("bubble"===s&&"scatter"===t||"scatter"===s&&"scatter"===t||"scatter"===s&&"line"===t)i=this.series.userOptions.name.split(", "),e=this.name?this.name.split(", "):[];else{if("column"!==s&&"line"!==s&&"scatter"!==s&&"area"!==s)return void console.log("Click dispatch for ".concat(t," ").concat(s," not supported."));i=this.series.userOptions.name.split(", "),e=I(this.category)}const a=o.row_pivots.map((t,s)=>[t,"==",e[s]]),l=o.column_pivots.map((e,t)=>[e,"==",i[t]]),c=o.filter.concat(a).concat(l).filter(e=>!!e[e.length-1]),h=this.index+1,u=h+1;let d=[];if("bubble"===s&&"scatter"===t||"scatter"===s&&"scatter"===t||"scatter"===s&&"line"===t)d=r;else{const e=this.series.userOptions?this.series.userOptions.stack:"",t=i[i.length-1];(e=>""==e.replace(/\s/g,""))(t)?d.push(e):d.push(t)}const p=await n._view.to_json({start_row:h,end_row:u});n.dispatchEvent(new CustomEvent("perspective-click",{bubbles:!0,composed:!0,detail:{column_names:d,config:{filters:c},row:p[0]}}))}}}}},tooltip:{animation:!1,backgroundColor:"#FFFFFF",borderColor:"#777777",followPointer:!1,valueDecimals:2,formatter:function(e){return n._view.schema(!1).then(t=>{let s=function(e,t,s,i,n){const o=n.row,r=n.column,a=o.length>0,l=r.length>0;if("y"===t){let t="",i="";if(a){t=B(o,I(e.key))}if(l){i=B(r,e.series.userOptions.name.split(", "))}const n=e.series.userOptions.stack,c=U(n,s);return"".concat(t,"\n                ").concat(i,"\n                <span>").concat(n,": </span><b>").concat(J(e.y,c),"</b>")}if("xy"===t){const t=K(i[0]),n=K(i[1]),c=K(i[2]),h=K(i[3]);let u="",d="",p="",f="",m="",g="";if(a){u=B(o,e.key.split(","))}if(l){d=B(r,e.point.series.name.split(","))}if(t){p=X(i[0],e.x,s)}if(n){f=X(i[1],e.y,s)}if(c){m=X(i[2],e.point.colorValue,s)}if(h){g=X(i[3],e.point.colorValue,s)}return[u,d,p,f,m,g].join("")}if("xyz"===t)return"<span>".concat(J(e.point.value),"</span>");if("hierarchy"===t)return"<span>".concat(e.point.id,": </span><b>").concat(J(e.x),"</b>");let c;return c=e.x?e.x:e.y,c}(this,i,t,r,l);e.label.attr({text:s})}).catch(e=>console.error(e)),"Loading..."},positioner:function(e,t,s){let i,n,o=this.chart;return i=s.plotX+e>o.plotWidth?s.plotX+o.plotLeft-e-5:s.plotX+o.plotLeft,n=s.plotY+t>o.plotHeight?s.plotY+o.plotTop-t:s.plotY+o.plotTop,{x:i,y:n}}}}}var se,ie=s(17),ne=s(18),oe=s.n(ne);function re(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}s.d(t,"a",(function(){return ae})),s.d(t,"b",(function(){return ce})),Object.setPrototypeOf(re.prototype,HTMLElement.prototype),Object.setPrototypeOf(re,HTMLElement);const ae=Symbol("Highcharts private");function le(e){let t;return this[ae]=this[ae]||{},t=this[ae].chart?this[ae].chart:this[ae].chart=document.createElement("perspective-highcharts"),document.body.contains(t)||(e.innerHTML="",e.appendChild(t)),t}const ce=(e,t,s)=>(async function(i,n,o,r,a){if(t&&(this._config=await n.get_config(),o.cancelled))return;const l=await n.get_config(),c=l.row_pivots,h=l.column_pivots,u=l.columns,[d,p]=await Promise.all([n.schema(!1),this._table.schema(!1,!1)]);let f;if(o.cancelled)return;let m=[],g=u.length>0?u[0]:void 0,b=d[g],_=u.length>1?u[1]:void 0,y=d[_],x=p[c.length>0?c[c.length-1]:void 0],v=p[h.length>0?h[h.length-1]:void 0],O=u.length;try{if("scatter"===e){let t;t=r||a?await n.to_columns({end_col:r,end_row:a,leaves_only:!0}):await n.to_columns();const i=m[0]=te.call(this,u,e),[o,l,p,f]=G(t,d,u,c,h);i.legend.floating=o.length<=20,i.legend.enabled=h.length>0,i.series=o,i.colors=o.length<=10?w:k,p[0]!==1/0&&(u.length<=3?i.chart.type="coloredScatter":i.chart.type="coloredBubble",C.call(this,i,p,s)),O<3&&Z(i,0,y),$(i,"xAxis",g,b,b,l),$(i,"yAxis",_,y,y,f),Q.call(this,i)}else if("heatmap"===e){let t;t=r||a?await n.to_json({end_col:r,end_row:a,leaves_only:!1}):await n.to_json();let i=m[0]=te.call(this,u,e),[o,l,h,d]=Y(t,c,v);i.series=[{name:null,data:o,nullColor:"none"}],i.legend.enabled=!0,i.legend.floating=!1,C.call(this,i,d,s),Z(i,0,y),ee(i,"xAxis",x,l),ee(i,"yAxis",v,h)}else if("treemap"===e||"sunburst"===e){let t;t=r||a?await n.to_json({end_col:r,end_row:a,leaves_only:!1}):await n.to_json();let[i,,o]=D(t,c,u,"treemap"===e);for(let t of i){let n=te.call(this,u,e);n.series=[t],i.length>1&&(n.title.text=t.title),n.plotOptions.series.borderWidth=1,n.legend.floating=!1,o&&C.call(this,n,o,s),m.push(n)}}else if("line"===e){let t,s=m[0]=te.call(this,u,e);if(0===h.length){let e;e=r||a?await n.to_columns({end_col:r,end_row:a,leaves_only:!0}):await n.to_columns(),t=await G(e,d,u,c,h)}else{let e;e=r||a?await n.to_json({end_col:r,end_row:a,leaves_only:!1}):await n.to_json(),t=await function(e,t,s,i,n){let o=new W(i.length,e),r=new R(o),a=[],l=[1/0,-1/0],c=new V(t,s);if(0===n.length){let e=q(a," ");for(let t of r){let i=c.make(t,s,l);i&&e.data.push(i)}}else{let t,s,i=[],n=Object.keys(e[0]).filter(e=>"__ROW_PATH__"!==e);for(let e of n){let n=e.split(M),o=n.slice(0,n.length-1).join(", ")||" ";if(void 0===t&&(t=o),s=q(a,t),t===o)i.push(e);else{for(let e of r){let t=c.make(e,i,l);t&&s.data.push(t)}t=o,i=[e]}}for(let e of r){let t=c.make(e,i,l);t&&s.data.push(t)}}return[a,{categories:c.xaxis_clean.names},l,{categories:c.yaxis_clean.names}]}(e,d,u,c,h)}const i=t[0],o=t[1],l=t[3],p=i.length<=10?w:k;s.legend.floating=i.length<=20,s.legend.enabled=h.length>0,s.series=i,s.plotOptions.scatter.marker={enabled:!1,radius:0},s.colors=p,Z(s,0,y)&&delete s.chart.type,$(s,"xAxis",g,b,b,o),$(s,"yAxis",_,y,y,l)}else{let t,s=m[0]=te.call(this,u,e);t=r||a?await n.to_columns({end_col:r,end_row:a,leaves_only:!1}):await n.to_columns();let[i,o]=function(e,t){let s=[],i=new L(e,t.length),n=new H(e,t.length);for(let e of n){let t=e.name.split(M),i=t[t.length-1];t=n.is_stacked?t.join(", ")||i:t.slice(0,t.length-1).join(", ")||" ";let o=P(e.data.map(e=>void 0===e||""===e?null:e),t,i);s.push(o)}return[s,i.axis]}(t,c);s.series=i,s.colors=i.length<=10?w:k,s.legend.enabled=h.length>0||i.length>1,s.legend.floating=i.length<=20,s.plotOptions.series.dataLabels={allowOverlap:!1,padding:10},(e.indexOf("scatter")>-1||e.indexOf("line")>-1)&&Z(s,0,y),ee(s,"xAxis",x,o),Object.assign(s,{yAxis:{startOnTick:!1,endOnTick:!1,title:{text:u.join(",  "),style:{color:"#666666",fontSize:"14px"}},labels:{overflow:"justify"}}})}}finally{f=le.call(this,i),(s||this.hasAttribute("updating"))&&f.delete()}f.render(e,m,this)});Object(ie.bindTemplate)(l.a,r.a)(se=class extends re{constructor(){super(),this._charts=[]}connectedCallback(){this._container=this.shadowRoot.querySelector("#container")}render(e,t,s){if(this._charts.length>0&&this._charts.length===t.length){let i=0;for(let o=0;o<this._charts.length;o++){const r=this._charts[o];let a=t[i++];if(a.boost){let e=r.renderTo;try{r.destroy()}catch(e){console.warn("Scatter plot destroy() call failed - this is probably leaking memory")}this._charts[o]=n.a.chart(e,a)}else if("scatter"===e){let e={series:a.series,plotOptions:{}};Q.call(s,e),r.update(e)}else{let e={series:a.series,xAxis:a.xAxis,yAxis:a.yAxis};r.update(e)}}}else{this.delete();for(let e of t){let t=document.createElement("div");t.className="chart",this._container.appendChild(t),this._charts.push(()=>n.a.chart(t,e))}for(let e=0;e<this._charts.length;e++)this._charts[e]=this._charts[e]()}this._charts.every(e=>this._container.contains(e.renderTo))||(this.remove(),this._charts.map(e=>this._container.appendChild(e.renderTo))),t.length>1&&this.resize(),oe()()&&setTimeout(()=>this.resize())}resize(){this._charts&&this._charts.length>0&&this._charts.map(e=>e.reflow())}remove(){this._charts=[];for(let e of Array.prototype.slice.call(this._container.children))"DIV"===e.tagName&&this._container.removeChild(e)}delete(){for(let e of this._charts)try{e.destroy()}catch(e){console.warn("Scatter plot destroy() call failed - this is probably leaking memory")}this.remove()}})},function(t,s){t.exports=e},function(e,s){e.exports=t},function(e,t){e.exports=s},function(e,t){e.exports=i},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t,s){"use strict";(function(e){s(3);var i=s(0);function n(){this[i.a]&&this[i.a].chart.resize()}function o(){this[i.a]&&this[i.a].chart.delete()}const r=25e3,a=25e3,l=1e5,c=25e3,h=2500,u=1e3,d=2e4,p=100,f=100,m=100,g=100,b=24,_=24,y=24,x={x_bar:{name:"X Bar Chart",create:Object(i.b)("x_bar",!0),update:Object(i.b)("x_bar",!1),resize:n,initial:{type:"number",count:1},selectMode:"select",delete:o,max_cells:c,max_columns:g},y_bar:{name:"Y Bar Chart",create:Object(i.b)("y_bar",!0),update:Object(i.b)("y_bar",!1),resize:n,initial:{type:"number",count:1},selectMode:"select",delete:o,max_cells:c,max_columns:g},y_line:{name:"Y Line Chart",create:Object(i.b)("y_line",!0),update:Object(i.b)("y_line",!1),resize:n,initial:{type:"number",count:1},selectMode:"select",delete:o,max_cells:r,max_columns:p},y_scatter:{name:"Y Scatter Chart",create:Object(i.b)("y_scatter",!0),update:Object(i.b)("y_scatter",!1),resize:n,initial:{type:"number",count:1},selectMode:"select",delete:o,max_cells:l,max_columns:m},y_area:{name:"Y Area Chart",create:Object(i.b)("y_area",!0),update:Object(i.b)("y_area",!1),resize:n,initial:{type:"number",count:1},selectMode:"select",delete:o,max_cells:a,max_columns:f},xy_line:{name:"X/Y Line Chart",create:Object(i.b)("line",!0),update:Object(i.b)("line",!1),resize:n,initial:{type:"number",count:2,names:["X Axis","Y Axis"]},selectMode:"toggle",delete:o,max_cells:l,max_columns:m},xy_scatter:{name:"X/Y Scatter Chart",create:Object(i.b)("scatter",!0),update:Object(i.b)("scatter",!1),resize:n,styleElement:Object(i.b)("scatter",!1,!0),initial:{type:"number",count:2,names:["X Axis","Y Axis","Color","Size"]},selectMode:"toggle",delete:o,max_cells:l,max_columns:m},treemap:{name:"Treemap",create:Object(i.b)("treemap",!0),update:Object(i.b)("treemap",!1),resize:n,styleElement:Object(i.b)("treemap",!1,!0),initial:{type:"number",count:2,names:["Size","Color"]},selectMode:"toggle",delete:function(){},max_cells:h,max_columns:b},sunburst:{name:"Sunburst",create:Object(i.b)("sunburst",!0),update:Object(i.b)("sunburst",!1),styleElement:Object(i.b)("sunburst",!1,!0),resize:n,initial:{type:"number",count:2,names:["Size","Color"]},selectMode:"toggle",delete:function(){},max_cells:u,max_columns:_},heatmap:{name:"Heatmap",create:Object(i.b)("heatmap",!0),update:Object(i.b)("heatmap",!1),resize:n,initial:{type:"number",count:1},selectMode:"select",delete:o,max_cells:d,max_columns:y}};t.a=function(...t){t=t.length>0?t:Object.keys(x);for(const s of t)e.registerPlugin(s,x[s])}}).call(this,s(20))},function(e,t,s){(e.exports=s(21)(!1)).push([e.i,":host{background-color:var(--plugin--background,#fff)}:host #container{position:absolute;width:calc(100% - 30px);height:calc(100% - 30px);display:grid;margin:15px;justify-content:stretch;grid-template-rows:repeat(auto-fit,minmax(400px,1fr));grid-template-columns:repeat(auto-fit,minmax(400px,1fr));overflow-y:auto}:host .chart{position:relative;width:100%;height:100%;min-width:0;min-height:0}:host .chart:last-child:first-child{position:absolute;top:0;left:0;right:0;bottom:0}:host text,:host tspan{font-family:var(--interface--font-family,Arial,sans-serif);fill:var(--highcharts-label--fill,#666)!important}:host .highcharts-null-point{fill:none}:host .highcharts-background{display:none}:host .highcharts-label-box.highcharts-tooltip-box:not([isShadow]){fill:var(--highcharts-tooltip--background,#fff)}:host .highcharts-yaxis-grid path.highcharts-grid-line{stroke:var(--highcharts-grid-line--stroke,#e6e6e6)}:host .highcharts-sunburst-series path,:host .highcharts-treemap-series rect{stroke:var(--plugin--background,#fff)}:host rect,:host svg image{opacity:var(--highcharts-rect--opacity,.5)}:host circle,:host path{opacity:var(--highcharts-circle--opacity,.8)}",""])},function(e,t){e.exports='<template id="perspective-highcharts">\n    <div id="container">\n\n    </div>\n</template>'},function(e,t){e.exports=r},function(e,t){e.exports=a},function(e,t){e.exports=l},function(e,t){e.exports=c},function(e,t){e.exports=h},function(e,t){e.exports=u},function(e,t){e.exports=d},function(e,t){e.exports=p},function(e,t){e.exports=f},function(e,t,s){"use strict";s.r(t);var i=s(7);Object(i.a)()},function(e,t){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(e){"object"==typeof window&&(s=window)}e.exports=s},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s=e[1]||"",i=e[3];if(!i)return s;if(t&&"function"==typeof btoa){var n=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),o=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[s].concat(o).concat([n]).join("\n")}var r;return[s].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+s+"}":s})).join("")},t.i=function(e,s){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},n=0;n<this.length;n++){var o=this[n][0];"number"==typeof o&&(i[o]=!0)}for(n=0;n<e.length;n++){var r=e[n];"number"==typeof r[0]&&i[r[0]]||(s&&!r[2]?r[2]=s:s&&(r[2]="("+r[2]+") and ("+s+")"),t.push(r))}},t}},function(e,t){e.exports=m}])}));
//# sourceMappingURL=perspective-viewer-highcharts.js.map