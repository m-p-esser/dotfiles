!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("faux-hypergrid/src/lib/Canvas"),require("@finos/perspective-viewer/dist/esm/custom_styles"),require("faux-hypergrid/src/cellEditors/Textfield"),require("core-js/modules/web.dom.iterable"),require("faux-hypergrid/src/behaviors/Behavior"),require("rectangular"),require("lodash/isEqual"),require("faux-hypergrid/src/cellRenderers"),require("lodash/cloneDeep"),require("@finos/perspective/dist/esm/config"),require("core-js/modules/es6.regexp.to-string"),require("core-js/modules/es6.regexp.split"),require("faux-hypergrid"),require("faux-hypergrid/src/Base"),require("fin-hypergrid-grouped-header-plugin"),require("superscript-number"),require("@finos/perspective/dist/esm/config/index.js"),require("@finos/perspective-viewer/dist/esm/utils.js"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.symbol"),require("core-js/modules/es6.array.sort"),require("datasaur-local"),require("core-js/modules/es6.regexp.replace")):"function"==typeof define&&define.amd?define(["faux-hypergrid/src/lib/Canvas","@finos/perspective-viewer/dist/esm/custom_styles","faux-hypergrid/src/cellEditors/Textfield","core-js/modules/web.dom.iterable","faux-hypergrid/src/behaviors/Behavior","rectangular","lodash/isEqual","faux-hypergrid/src/cellRenderers","lodash/cloneDeep","@finos/perspective/dist/esm/config","core-js/modules/es6.regexp.to-string","core-js/modules/es6.regexp.split","faux-hypergrid","faux-hypergrid/src/Base","fin-hypergrid-grouped-header-plugin","superscript-number","@finos/perspective/dist/esm/config/index.js","@finos/perspective-viewer/dist/esm/utils.js","core-js/modules/es7.symbol.async-iterator","core-js/modules/es6.symbol","core-js/modules/es6.array.sort","datasaur-local","core-js/modules/es6.regexp.replace"],t):"object"==typeof exports?exports["perspective-viewer-hypergrid"]=t(require("faux-hypergrid/src/lib/Canvas"),require("@finos/perspective-viewer/dist/esm/custom_styles"),require("faux-hypergrid/src/cellEditors/Textfield"),require("core-js/modules/web.dom.iterable"),require("faux-hypergrid/src/behaviors/Behavior"),require("rectangular"),require("lodash/isEqual"),require("faux-hypergrid/src/cellRenderers"),require("lodash/cloneDeep"),require("@finos/perspective/dist/esm/config"),require("core-js/modules/es6.regexp.to-string"),require("core-js/modules/es6.regexp.split"),require("faux-hypergrid"),require("faux-hypergrid/src/Base"),require("fin-hypergrid-grouped-header-plugin"),require("superscript-number"),require("@finos/perspective/dist/esm/config/index.js"),require("@finos/perspective-viewer/dist/esm/utils.js"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.symbol"),require("core-js/modules/es6.array.sort"),require("datasaur-local"),require("core-js/modules/es6.regexp.replace")):e["perspective-viewer-hypergrid"]=t(e["faux-hypergrid/src/lib/Canvas"],e["@finos/perspective-viewer/dist/esm/custom_styles"],e["faux-hypergrid/src/cellEditors/Textfield"],e["core-js/modules/web.dom.iterable"],e["faux-hypergrid/src/behaviors/Behavior"],e.rectangular,e["lodash/isEqual"],e["faux-hypergrid/src/cellRenderers"],e["lodash/cloneDeep"],e["@finos/perspective/dist/esm/config"],e["core-js/modules/es6.regexp.to-string"],e["core-js/modules/es6.regexp.split"],e["faux-hypergrid"],e["faux-hypergrid/src/Base"],e["fin-hypergrid-grouped-header-plugin"],e["superscript-number"],e["@finos/perspective/dist/esm/config/index.js"],e["@finos/perspective-viewer/dist/esm/utils.js"],e["core-js/modules/es7.symbol.async-iterator"],e["core-js/modules/es6.symbol"],e["core-js/modules/es6.array.sort"],e["datasaur-local"],e["core-js/modules/es6.regexp.replace"])}(window,(function(__WEBPACK_EXTERNAL_MODULE__1__,__WEBPACK_EXTERNAL_MODULE__2__,__WEBPACK_EXTERNAL_MODULE__3__,__WEBPACK_EXTERNAL_MODULE__4__,__WEBPACK_EXTERNAL_MODULE__6__,__WEBPACK_EXTERNAL_MODULE__7__,__WEBPACK_EXTERNAL_MODULE__8__,__WEBPACK_EXTERNAL_MODULE__9__,__WEBPACK_EXTERNAL_MODULE__10__,__WEBPACK_EXTERNAL_MODULE__11__,__WEBPACK_EXTERNAL_MODULE__12__,__WEBPACK_EXTERNAL_MODULE__13__,__WEBPACK_EXTERNAL_MODULE__14__,__WEBPACK_EXTERNAL_MODULE__15__,__WEBPACK_EXTERNAL_MODULE__16__,__WEBPACK_EXTERNAL_MODULE__18__,__WEBPACK_EXTERNAL_MODULE__20__,__WEBPACK_EXTERNAL_MODULE__21__,__WEBPACK_EXTERNAL_MODULE__29__,__WEBPACK_EXTERNAL_MODULE__30__,__WEBPACK_EXTERNAL_MODULE__31__,__WEBPACK_EXTERNAL_MODULE__32__,__WEBPACK_EXTERNAL_MODULE__34__){return function(e){var t={};function i(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(o,r,function(t){return e[t]}.bind(null,r));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=27)}([function(e,t,i){"use strict";i.d(t,"d",(function(){return l})),i.d(t,"a",(function(){return c})),i.d(t,"c",(function(){return h})),i.d(t,"b",(function(){return g}));var o=i(2),r=i(10),n=i.n(r);const s=new o.PropsBuilder,a="--hypergrid";function l(e){return s.get_properties(e)}function c(e){return s.clear_properties(e)}s.add_fonts({font:a,columnHeaderFont:"".concat(a,"-header"),columnHeaderForegroundSelectionFont:"".concat(a,"-header"),foregroundSelectionFont:"".concat(a,"-header"),rowHeaderFont:a,treeHeaderFont:a}),s.add_styles({treeHeaderBackgroundColor:"".concat(a,"-tree-header--background"),backgroundColor:"".concat(a,"--background"),treeHeaderColor:"".concat(a,"-tree-header--color"),treeHeaderForegroundSelectionColor:"".concat(a,"-tree-header-selection--color"),treeHeaderBackgroundSelectionColor:"".concat(a,"-tree-header-selection--background"),backgroundSelectionColor:"".concat(a,"-selection--background"),foregroundSelectionColor:["".concat(a,"--color"),"color"],borderBottom:"".concat(a,"--border-bottom-color"),borderRight:"".concat(a,"--border-right-color"),borderBottomPositive:"".concat(a,"-positive--border-bottom-color"),borderBottomNegative:"".concat(a,"-negative--border-bottom-color"),borderRightPositive:"".concat(a,"-positive--border-right-color"),borderRightNegative:"".concat(a,"-negative--border-right-color"),color:["".concat(a,"--color"),"color"],columnHeaderBackgroundColor:"".concat(a,"-header--background"),columnHeaderSeparatorColor:"".concat(a,"-separator--color"),columnHeaderColor:"".concat(a,"-header--color"),columnHeaderForegroundSelectionColor:"".concat(a,"-header--color"),columnColorNumberPositive:"".concat(a,"-positive--color"),columnColorNumberNegative:"".concat(a,"-negative--color"),columnBackgroundColorNumberPositive:"".concat(a,"-positive--background"),columnBackgroundColorNumberNegative:"".concat(a,"-negative--background"),selectionRegionOverlayColor:"".concat(a,"-editor--background"),selectionRegionOutlineColor:"".concat(a,"-editor--border-color"),gridLinesVColor:"".concat(a,"-gridline--color"),gridLinesHColor:"".concat(a,"-gridline--color"),lineColor:"".concat(a,"-gridline--color"),fixedLinesVColor:"".concat(a,"-gridline--color"),fixedLinesHColor:"".concat(a,"-gridline--color"),halign:"".concat(a,"--text-align"),columnHeaderHalign:"".concat(a,"--text-align"),hoverCellHighlight:{enabled:!0,backgroundColor:"".concat(a,"-cell-hover--background"),color:"".concat(a,"-cell-hover--color")}}),s.add_measures({defaultRowHeight:"".concat(a,"-row--height"),groupedHeader:{flatHeight:"".concat(a,"-row--height")},width:"".concat(a,"--width"),minimumColumnWidth:"".concat(a,"--min-width"),maximumColumnWidth:"".concat(a,"--max-width")}),s.add_styles({hoverRowHighlight:{enabled:!0,backgroundColor:"".concat(a,"-row-hover--background"),color:"".concat(a,"-row-hover--color")}});const d={autoSelectRows:!1,cellPadding:5,cellSelection:!1,columnSelection:!1,rowSelection:!1,checkboxOnlyRowSelections:!1,columnClip:!0,treeHeaderBackgroundSelectionColor:"rgba(147, 185, 255, 0.625)",columnHeaderFont:"12px Helvetica, sans-serif",columnHeaderForegroundSelectionFont:"12px Helvetica, sans-serif",columnHeaderBackgroundSelectionColor:void 0,columnsReorderable:!1,defaultRowHeight:24,enableContinuousRepaint:!1,feedbackCount:1e6,fixedColumnCount:0,fixedRowCount:0,fixedLinesHWidth:1,fixedLinesVWidth:1,font:'12px "Arial", Helvetica, sans-serif',foregroundSelectionFont:'12px "Arial", Helvetica, sans-serif',gridLinesH:!1,gridLinesV:!0,gridLinesUserDataArea:!1,groupedHeader:{flatHeight:"30",paintBackground:null,columnHeaderLines:!1,groupConfig:[{halign:"center",font:"12px Open Sans, sans-serif"}]},halign:"left",headerTextWrapping:!1,hoverColumnHighlight:{enabled:!1},hoverRowHighlight:{enabled:!0,backgroundColor:"#555"},hoverCellHighlight:{enabled:!0,backgroundColor:"#333"},noDataMessage:"",minimumColumnWidth:50,multipleSelections:!1,renderFalsy:!1,rowHeaderFont:"12px Arial, Helvetica, sans-serif",rowHeaderForegroundSelectionFont:'12px "Arial", Helvetica, sans-serif',rowResize:!0,scrollbarHoverOff:"visible",rowHeaderCheckboxes:!1,rowHeaderNumbers:!1,selectionRegionOverlayColor:"transparent",selectionRegionOutlineColor:"rgba(0,0,0,0.2)",showFilterRow:!0,showHeaderRow:!0,showTreeColumn:!1,showRowNumbers:!1,showCheckboxes:!1,singleRowSelectionMode:!1,sortColumns:[],sortOnDoubleClick:!0,treeRenderer:"TreeCell",treeHeaderFont:"12px Arial, Helvetica, sans-serif",treeHeaderForegroundSelectionFont:'12px "Arial", Helvetica, sans-serif',useBitBlit:!1,vScrollbarClassPrefix:"",voffset:0},_={backgroundColor:"#ffffff",color:"#666",font:'12px "Open Sans", Helvetica, sans-serif',columnHeaderColor:"#666",columnHeaderHalign:"left",columnHeaderBackgroundColor:"#fff",columnHeaderForegroundSelectionColor:"#333",rowHeaderForegroundSelectionFont:"12px Arial, Helvetica, sans-serif",treeHeaderColor:"#666",treeHeaderBackgroundColor:"#fff",hoverCellHighlight:{enabled:!0,backgroundColor:"#eeeeee"},hoverRowHighlight:{enabled:!0,backgroundColor:"#f6f6f6"}},u={rowBackgroundSelectionColor:"rgba(147, 185, 255, 0.625)",cellBackgroundSelectionColor:"#fff",rowSelectionRegionOutlineColor:"transparent",cellSelectionRegionOutlineColor:"rgba(0,0,0,0.2)"};function h(e,t){const i={singleRowSelectionMode:t,autoSelectRows:t,rowSelection:t};return t?(i.selectionRegionOutlineColor=Object(o.get_style)(e,"".concat(a,"-selection--border-color"))||u.rowSelectionRegionOutlineColor,i.backgroundSelectionColor=Object(o.get_style)(e,"".concat(a,"-selection--background"))||u.rowBackgroundSelectionColor):(i.selectionRegionOutlineColor=Object(o.get_style)(e,"".concat(a,"-editor--border-color"))||u.cellSelectionRegionOutlineColor,i.backgroundSelectionColor=u.rowSelectionRegionOutlineColor),i}function g(){return Object.assign({},n()(d),n()(_))}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__2__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__3__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__4__},function(e,t,i){i(13),i(4);const o="|",r=i(6).prototype.treeColumnIndex;function n(e,t,i){const o=Object.keys(e),n=o.length>0?o[0]:void 0;if(void 0===n)return[];const s=!!t.length,a=t.length?i.filter(e=>"__ROW_PATH__"!==e):i,l=o.map(e=>a.indexOf(e)),c=[];for(let i=0;i<e[n].length;i++){const n={};for(const t in o){const r=o[t];n[l[t]]=e[r][i]}if(s){void 0===e.__ROW_PATH__[i]&&(e.__ROW_PATH__[i]=[]);let o=e.__ROW_PATH__[i][e.__ROW_PATH__[i].length-1];void 0===o&&0===i&&(o="TOTAL"),n[r]={rollup:o,rowPath:["ROOT"].concat(e.__ROW_PATH__[i]),isLeaf:e.__ROW_PATH__[i].length>=t.length}}e.__ID__&&(n.__ID__=e.__ID__[i].join("|")),e.__INDEX__&&(n.__INDEX__=e.__INDEX__[i][0]),c.push(n)}return c}e.exports={psp2hypergrid:function(e,t,i,r,s){const a=(r.length?s.filter(e=>"__ROW_PATH__"!==e):s).map(e=>e.split(o)),l=!!r.length;return{rows:n(e,r,s),isTree:l,configuration:{},rowPivots:r,columnPaths:(l?[[" "]]:[]).concat(a),columnTypes:(l?[r.map(e=>i[e])]:[]).concat(a.map(e=>t[e[e.length-1]]))}},page2hypergrid:n}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__6__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__7__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__8__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__9__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__10__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__11__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__12__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__13__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__14__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__15__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__16__},function(e,t,i){"use strict";i.r(t),i.d(t,"install",(function(){return b}));i(4),i(13),i(31),i(12);var o=i(7),r=i.n(o),n=i(18),s=i.n(n),a=i(8),l=i.n(a),c=i(9),d=i.n(c),_=d.a.BaseClass.extend("Borders",{paint:function(e,t){var i,o=t.bounds,r=o.x,n=o.y,s=o.width,a=o.height-1;e.save(),e.translate(-.5,.5),e.cache.lineWidth=1,(i=t.borderTop)&&(e.beginPath(),e.moveTo(r,n),e.lineTo(r+s,n),e.cache.strokeStyle=i,e.stroke()),(i=t.borderRight)&&(e.beginPath(),e.moveTo(r+s,n),e.lineTo(r+s,n+a),e.cache.strokeStyle=i,e.stroke()),(i=t.borderBottom)&&(e.beginPath(),e.moveTo(r,n+a),e.lineTo(r+s,n+a),e.cache.strokeStyle=i,e.stroke()),(i=t.borderLeft)&&(e.beginPath(),e.moveTo(r,n),e.lineTo(r,n+a),e.cache.strokeStyle=i,e.stroke()),e.restore()}});function u(e,t=!1){const i=[];e.isTree&&(i[this.treeColumnIndex]={name:this.treeColumnIndex.toString(),header:" "}),e.columnPaths.forEach((function(t,o){const r=t.join("|"),n=e.configuration.columnAliases,s=n&&n[r]||r,a=o.toString(),l=e.columnTypes[o];e.isTree&&0===o?i[-1]={name:a,header:s,type:l}:i.push({name:a,header:s,type:l,index:o-(e.isTree?1:0)})})),this.grid.properties.showTreeColumn=e.isTree;const o=this.grid.behavior.dataModel._config,r=!(0===o.row_pivots.length&&o.column_pivots.length>0)&&this.grid.behavior.dataModel._viewer.hasAttribute("selectable");this.grid.addProperties(this.grid.get_dynamic_styles(r)),this.createColumns=h,this.refreshColumns=g,!t&&this._memoized_schema&&l()(this._memoized_schema.slice(0,this._memoized_schema.length),i.slice(0,i.length))&&l()(e.rowPivots,this._memoized_pivots)?(this.grid.sbVScroller.index=0,this.grid.behavior.dataModel.data=e.rows,this.grid.behavior.dataModel._data_window=void 0):(this.grid.sbVScroller.index=0,this.grid.sbHScroller.index=0,this.grid.selectionModel.clear(),this.grid.setData({data:e.rows,schema:i})),this._memoized_schema=i,this._memoized_pivots=e.rowPivots}function h(){Object.getPrototypeOf(this).createColumns.call(this),this.refreshColumns(),this.setHeaders(),this.schema_loaded=!0}function g(){this.getActiveColumns().forEach((function(e){p.call(this,e)}),this);let e=this.getTreeColumn();e&&p.call(this,e)}function p(e){const t=e.properties;e.index===this.treeColumnIndex?t.format="FinanceTree":t.format="perspective-".concat(e.type);const i=this.grid.behavior.dataModel._config;this.grid.behavior.dataModel._viewer.hasAttribute("editable")&&0===i.row_pivots.length&&0===i.column_pivots.length&&(t.editor={integer:"perspective-number",string:"perspective-text",date:"perspective-date",datetime:"perspective-datetime",float:"perspective-number"}[e.type],Object.assign(t,{editable:!0,editOnKeydown:!0,editOnNextCell:!1,editOnDoubleClick:!0,editorActivationKeys:["alt","esc"],cellSelection:!0}));const o=this.grid.get_styles();o[e.type]&&Object.assign(t,o[e.type])}function f(e){const t=this.dataModel.getConfig(),i=t.sort.findIndex(t=>t[0]===e.trim());if(i>-1){const o=t.sort[i][1];o in this.charMap&&(e="".concat(e," ").concat(this.charMap[o]).concat(t.sort.length>1?s()(i+1):""))}return e}function v(e){e.preventDefault(),e.handled=!0;const t=this.behavior.dataModel.getConfig(),i=this.behavior.getColumn(e.detail.column);let o,r;t.column_pivots.length>0?(o=!0,r=i.header.split("|")[t.column_pivots.length]):(o=!1,r=i.header);const n=this.behavior.dataModel._viewer,s=t.sort.findIndex(e=>e[0]===r.trim()),a=s>-1,l=e.detail.keys&&(e.detail.keys.indexOf("ALTSHIFT")>-1||e.detail.keys.indexOf("ALT")>-1)&&"string"!==i.type,c=e.detail.keys&&(e.detail.keys.indexOf("ALTSHIFT")>-1||e.detail.keys.indexOf("SHIFT")>-1);let d;if(a){const e=t.sort[s],i=e[1];d=n._increment_sort(i,o,l),e[1]=d}else d=n._increment_sort("none",o,l);c&&a?("none"===d&&t.sort.splice(s,1),n.sort=JSON.stringify(t.sort)):c?(t.sort.push([r,d]),n.sort=JSON.stringify(t.sort)):n.sort=JSON.stringify([[r,d]])}d.a.add(_);const m=e=>{const t=e.detail.primitiveEvent,i=new MouseEvent(t.type,t);e.target.parentElement.parentElement.parentElement.dispatchEvent(i)},b=function(e){var t;t=e.behavior.charMap,Object.assign(t,{asc:"\u2191",desc:"\u2193","asc abs":"\u21e7","desc abs":"\u21e9","col asc":"\u2192","col desc":"\u2190","col asc abs":"\u21e8","col desc abs":"\u21e6"}),Object.getPrototypeOf(e.behavior).setPSP=u,Object.getPrototypeOf(e.behavior).formatColumnHeader=f,e.addEventListener("fin-column-sort",v.bind(e)),e.addEventListener("fin-canvas-context-menu",m),Object.getPrototypeOf(e.behavior).cellClicked=async function(e){e.primitiveEvent.preventDefault(),e.handled=!0;const{x:t,y:i}=e.dataCell,o=this.dataModel.getConfig(),r=o.row_pivots,n=o.column_pivots,s=i>=0?i:0,a=s+1,l=await this.dataModel._view.to_json({start_row:s,end_row:a}),c=l.map(e=>e.__ROW_PATH__)[0]||[],d=r.map((e,t)=>{const i=c[t];return i?[e,"==",i]:void 0}).filter(e=>e),_=r.length>0?t+1:t,u=Object.keys(l[0])[_];let h,g=[];if(u){const e=u.split("|");h=[e[e.length-1]],g=n.map((t,i)=>{const o=e[i];return o?[t,"==",o]:void 0}).filter(e=>e).filter(([,,e])=>"__ROW_PATH__"!==e)}const p=o.filter.concat(d).concat(g),f=this.grid.properties.rowSelection&&-1===this.grid.getSelectedRows().indexOf(i)?"deselected":"selected";return this.grid.canvas.dispatchEvent(new CustomEvent("perspective-click",{bubbles:!0,composed:!0,detail:{config:{filters:p},column_names:h,row:l[0],action:f}})),this.dataModel.toggleRow(e.dataCell.y,e.dataCell.x,e)};const i=e.renderer.renderGrid;function o(){this.width=Math.floor(this.div.clientWidth),this.height=Math.floor(this.div.clientHeight),this.bounds=new r.a.Rectangle(0,0,this.width,this.height),this.component.setBounds(this.bounds)}e.renderer.renderGrid=function(e){i.call(this,e),this.renderOverrides(e),this.renderLastSelection(e)},e.canvas.canvas.addEventListener("mousewheel",e=>{e.shiftKey&&e.stopPropagation()}),e.canvas.hasFocus=function(){if(!e.div.isConnected)return;const t=e.div.parentNode.parentNode.host;return t.parentNode.parentNode.parentNode.parentNode.parentNode.activeElement===t},e.lookupFeature("CellSelection").handleMouseDown=function(e,t){var i=t.gridCell.x,o=t.dataCell.y;if(e.behavior.getCellProperty(t.dataCell.x,t.gridCell.y,"cellSelection")&&t.isDataCell&&!t.primitiveEvent.detail.isRightClick){var r=e.newPoint(i,o),n=t.primitiveEvent.detail.keys;this.extendSelection(e,r,n)}else this.next&&this.next.handleMouseDown(e,t)},e.lookupFeature("CellSelection").extendSelection=function(e,t,i){var o=i.indexOf("CTRL")>=0,r=e.getMouseDown(),n=t.x,s=t.y;if(!(n<0||s<0)){if(o&&n===r.x&&s===r.y)return e.clearMostRecentSelection(),e.popMouseDown(),void e.repaint();o||e.clearSelections(),e.select(n,s,0,0),e.setMouseDown(e.newPoint(n,s)),e.setDragExtent(e.newPoint(0,0)),e.repaint()}},e.lookupFeature("CellSelection").handleDOWN=function(e,t){if(t.primitiveEvent.preventDefault(),!e.cellEditor){const t=this.getAutoScrollAcceleration();let{x:i,y:o}=e.selectionModel.getLastSelection().origin;o+t>e.renderer.dataWindow.origin.y+e.renderer.dataWindow.extent.y-2&&e.sbVScroller.index++,o=Math.min(e.behavior.dataModel.getRowCount()-1,o+t),e.selectionModel.select(i,o,0,0),e.repaint()}},e.lookupFeature("CellSelection").handleUP=function(e,t){if(t.primitiveEvent.preventDefault(),!e.cellEditor){const t=this.getAutoScrollAcceleration();let{x:i,y:o}=e.selectionModel.getLastSelection().origin;o-t<e.renderer.dataWindow.origin.y&&e.sbVScroller.index--,o=Math.max(0,o-t),e.selectionModel.select(i,o,0,0),e.repaint()}},e.lookupFeature("CellSelection").handleLEFT=function(e,t){if(t.primitiveEvent.preventDefault(),!e.cellEditor){const t=this.getAutoScrollAcceleration();let{x:i,y:o}=e.selectionModel.getLastSelection().origin;i-t<e.renderer.dataWindow.origin.x&&e.sbHScroller.index--,i=Math.max(0,i-1),e.selectionModel.select(i,o,0,0),e.repaint()}},e.lookupFeature("CellSelection").handleRIGHT=function(e,t){if(t.primitiveEvent.preventDefault(),!e.cellEditor){const t=this.getAutoScrollAcceleration();let{x:i,y:o}=e.selectionModel.getLastSelection().origin;i+t>e.renderer.dataWindow.origin.x+e.renderer.dataWindow.extent.x-1&&e.sbHScroller.index++,i=Math.min(e.behavior.schema.length-1,i+t),e.selectionModel.select(i,o,0,0),e.repaint()}},e.lookupFeature("CellSelection").moveShiftSelect=function(e,t,i){e.moveSingleSelect(t,i)},e.canvas.resize=async function(t){let i=1;const n=window.devicePixelRatio&&this.component.properties.useHiDPI;if(n){i=(window.devicePixelRatio||1)/(this.gc.webkitBackingStorePixelRatio||this.gc.mozBackingStorePixelRatio||this.gc.msBackingStorePixelRatio||this.gc.oBackingStorePixelRatio||this.gc.backingStorePixelRatio||1)}o.call(this);let s=!0;const a=performance.now(),l=this.component.grid.behavior.dataModel;if(this.height*i!==this.canvas.height||this.width*i!==this.canvas.width||t)for(;l._view&&s;){if(performance.now()-a>3e3)throw new Error("Timeout");"object"==typeof s&&await new Promise(setTimeout),o.call(this),s=await new Promise(e=>l.fetchData(void 0,e))}this.bounds=new r.a.Rectangle(0,0,this.width,this.height),this.component.setBounds(this.bounds),l._view&&this.resizeNotification(),this.buffer.width=this.canvas.width=this.width*i,this.buffer.height=this.canvas.height=this.height*i,this.canvas.style.width=this.buffer.style.width=this.width+"px",this.canvas.style.height=this.buffer.style.height=this.height+"px",this.bc.scale(i,i),n&&!this.component.properties.useBitBlit&&this.gc.scale(i,i),this.component.grid.renderer.needsComputeCellsBounds=!1,e.canvas.paintNow()}}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__18__},function(e,t,i){"use strict";var o=i(6),r=i.n(o),n=i(20),s=i(5);const{prototype:{treeColumnIndex:a}}=r.a;function l(e){if(!this.dataWindow)return[];const t=this.dataWindow;return this.grid.newRectangle(t.left,t.top,t.width,e?Math.min(e-t.top,t.height):t.height)}function c(e,t){for(let i in e)if(e[i].__ID__===t)return parseInt(i);return-1}var d;function _(e,t){return!t||e.top!==t.top||e.top+e.height!==t.top+t.height||e.left!==t.left||e.left+e.width!==t.left+t.width}function u(e){if(null===e.value||void 0===e.value)e.value="-";else{let t=this.schema[e.dataCell.x].type;const i=Object(n.get_type_config)(t);i.type&&(t=i.type),["number","float","integer"].indexOf(t)>-1?0===e.value?e.value="float"===t?"0.00":"0":isNaN(e.value)?e.value="-":e.value>0?(e.color=e.columnColorNumberPositive||"rgb(160,207,255)",e.backgroundColor=e.columnBackgroundColorNumberPositive?e.columnBackgroundColorNumberPositive:e.backgroundColor,e.borderBottom=e.borderBottomPositive?e.borderBottomPositive:e.borderBottom,e.borderRight=e.borderRightPositive?e.borderRightPositive:e.borderRight):(e.color=e.columnColorNumberNegative||"rgb(255,136,136)",e.backgroundColor=e.columnBackgroundColorNumberNegative?e.columnBackgroundColorNumberNegative:e.backgroundColor,e.borderBottom=e.borderBottomNegative?e.borderBottomNegative:e.borderBottom,e.borderRight=e.borderRightNegative?e.borderRightNegative:e.borderRight):"boolean"===t&&(e.value=String(e.value))}}t.a=i(32).extend("PerspectiveDataModel",{isTreeCol:function(e){return e===a&&this.isTree()},getValue:function(e,t){var i=this.data[t];return i?i[e]:null},getRowCount:function(){return this._nrows||0},getConfig:function(){return this._config},setRowCount:function(e){this._nrows=e||0},isTree:function(){return this._isTree},setIsTree:function(e){this._isTree=e},setDirty:function(e){this._grid&&(e!==this._nrows&&this._grid.renderer.computeCellsBounds(),this._dirty=!0,this._nrows=e)},toggleRow:async function(e,t,i){if(this.isTreeCol(t)){let o=!1;i.primitiveEvent.detail.primitiveEvent&&(o=!!i.primitiveEvent.detail.primitiveEvent.shiftKey);let r=await this._view.get_row_expanded(e);o?r?1===this.data[e][t].rowPath.length?this._view.collapse(e):this._view.set_depth(this.data[e][t].rowPath.length-2):this._view.set_depth(this.data[e][t].rowPath.length-1):r?this._view.collapse(e):this._view.expand(e);let n=await this._view.num_rows();this.setDirty(n),this._grid.canvas.paintNow()}},_update_select_index:function(){const e=this._grid.selectionModel.hasSelections(),t=this._grid.selectionModel.hasRowSelections();if(e){const e=this.data[this._grid.selectionModel.getLastSelection().origin.y];e&&(this._selected_cell_index=e.__ID__)}if(t){const e=this.data[this._grid.getSelectedRows()[0]];e&&(this._selected_row_index=e.__ID__)}},_update_editor:function(e){const t=this._grid.cellEditor;let i;return t&&(i=c(this.data,t._index),t.event.resetGridXY(t.event.dataCell.x,i-e.origin.y+1),t.moveEditor()),i},_update_selection:function(e){if(this._grid.selectionModel.hasSelections()&&-1!==(e=e||c(this.data,this._selected_cell_index))){const t=this._grid.selectionModel.getLastSelection().origin.x;this._grid.selectionModel.select(t,e,0,0)}if(this._selected_row_index){this._grid.selectionModel.clearRowSelection();const t=e||c(this.data,this._selected_row_index);-1!==t&&this._grid.selectionModel.selectRow(t)}},pspFetch:async function(e){this._grid.properties.rowSelection||this._viewer.hasAttribute("editable");const t=function(e,t=[],i=!1){const o={start_row:e.origin.y,end_row:e.corner.y+1,start_col:e.origin.x,end_col:e.corner.x+3};return o.end_col+=t&&t.length>0?1:0,o.id=i,o}(e,this._config.row_pivots,this._viewer.hasAttribute("settings")),i=await this._view.to_columns(t);this.data=[];const o=Object(s.page2hypergrid)(i,this._config.row_pivots,this._columns),r=t.start_row,n=this.data;o.forEach((e,t)=>n[r+t]=e)},fetchData:(d=async function(){if(void 0===this._view)return!0;let e=l.call(this._grid.renderer);if(!this._dirty&&!_(e,this._data_window))return;if(this._grid.renderer.needsComputeCellsBounds=!0,this._outstanding&&!_(e,this._outstanding.rect))return await this._outstanding.req,this._grid.renderer.needsComputeCellsBounds=!0,!0;this._dirty=!1;const t=this.pspFetch(e);this._outstanding={rect:e,req:t},this._update_select_index();try{await t}finally{this._outstanding=void 0,this._grid.renderer.needsComputeCellsBounds=!0}return this._data_window=e,this._update_selection(this._update_editor(e)),e=l.call(this._grid.renderer),_(e,this._data_window)},async function(e,t){let i;try{i=await d.call(this)}catch(e){return void t(e)}t(i)}),getCellEditorAt:function(e,t,i,o){if(!i)return;const r=this._grid.renderer.dataWindow.top,n=this._grid.cellEditors.create(i,o);this._grid.selectionModel.select(e,t+r-1),n.el.addEventListener("blur",()=>setTimeout(()=>n.cancelEditing()));const s={start_row:t+r-1,end_row:t+r,start_col:e,end_col:e+1,index:!0};return n._row=this._view.to_json(s),n._table=this._table,n._data=this.data,n._canvas=this._grid.canvas.canvas,n._index=this.data[t+r-1].__ID__,n},getCell:function(e,t){var i,o;return e.isUserDataArea?u.call(this,e,t):e.dataCell.x===a&&e.value&&(o=(i=this.getRow(e.dataCell.y+1))?e.value.rowPath.length-i[a].rowPath.length:1,e.last=0!==o,e.expanded=o<0,e._type=this.schema[-1].type[e.value.rowPath.length-2]),e.grid.cellRenderers.get(t)},clearSelectionState:function(){this._selected_row_index=void 0,this._selected_cell_index=void 0,this._grid.selectionModel.clear()}})},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__20__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__21__},function(e,t){e.exports="\x3c!--\n   \n   Copyright (c) 2017, the Perspective Authors.\n   \n   This file is part of the Perspective library, distributed under the terms of\n   the Apache License 2.0.  The full license can be found in the LICENSE file.\n\n--\x3e\n\n<template id='perspective-hypergrid'>\n    <div id='gridWrapper'>\n        <div id='mainGrid'></div>\n    </div>\n</template>"},function(e,t,i){(e.exports=i(33)(!1)).push([e.i,':host{position:absolute;outline:0;top:0;left:0;bottom:0;right:0}:host table{font:12px "Open Sans",helvetica,sans-serif}:host td.hover{background-color:#eee}:host tr.hover{background-color:#f6f6f6}:host td.positive{color:#1078d1}:host td.negative{color:#de3838}:host input.hypergrid-textfield{position:absolute;outline:0;border:1px solid var(--hypergrid-editor--border-color,rgba(0,0,0,.4));color:var(--hypergrid--color,inherit);background:var(--hypergrid--background,#fff);box-sizing:border-box;padding:0 4px 3px 5px}:host #gridWrapper{box-sizing:border-box;width:100%;height:100%;margin:0;padding:var(--hypergrid--padding,0)}:host #mainGrid{position:relative;width:100%;height:100%;margin:0;padding:0}:host #mainGrid>div{position:absolute;width:100%;height:100%;overflow:hidden}:host #mainGrid input{margin:0}:host div.finbar-vertical{margin:0!important;width:15px!important;box-shadow:0 0 0 #000,0 0 0 #000,0 0 0 #000}:host div.finbar-vertical div.thumb{width:var(--hypergrid-scrollbar--width,13px);right:-1px;background-color:#9e9e9e;box-shadow:0 0 0 #000,0 0 0 #000,0 0 0 #000;margin:0!important;border-radius:var(--hypergrid-scrollbar--border-radius,0)}:host div.finbar-horizontal{margin:0!important;height:15px!important;box-shadow:0 0 0 #000,0 0 0 #000,0 0 0 #000}:host div.finbar-horizontal div.thumb{margin:-3px 2px;height:var(--hypergrid-scrollbar--width,13px);bottom:4px;background-color:#9e9e9e;box-shadow:0 0 0 #000,0 0 0 #000,0 0 0 #000;border-radius:var(--hypergrid-scrollbar--border-radius,0)}',""])},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return set_formatters}));var _finos_perspective_dist_esm_config__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(11),_finos_perspective_dist_esm_config__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_finos_perspective_dist_esm_config__WEBPACK_IMPORTED_MODULE_0__);function null_formatter(e,t=""){let i=e.format.bind(e);return e.format=e=>{if("string"==typeof e)return e;if(t===e)return"-";let o=i(e);return""===o?"-":o},e}function custom_formatter(e,t){let i=e.format.bind(e);return e.format=e=>(e=t(i(e)))||"-",e}function set_formatters(grid){const formatters={};for(const type of Object(_finos_perspective_dist_esm_config__WEBPACK_IMPORTED_MODULE_0__.get_types)()){const config=Object(_finos_perspective_dist_esm_config__WEBPACK_IMPORTED_MODULE_0__.get_type_config)(type),format_function={float:grid.localization.NumberFormatter,integer:grid.localization.NumberFormatter,datetime:grid.localization.DateFormatter,date:grid.localization.DateFormatter}[config.type||type];format_function&&("string"==typeof config.format?formatters[type]=custom_formatter(new format_function("en-us"),eval(config.format)):formatters[type]=null_formatter(new format_function("en-us",config.format),config.null_value),grid.localization.add("perspective-".concat(type),formatters[type]))}grid.localization.header={format:e=>grid.behavior.formatColumnHeader(e)},grid.localization.add("FinanceTree",{format:function(e,t){const i=formatters[t];return i?i.format(e):e},parse:e=>e})}},function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));i(34),i(4);var o=i(3),r=i.n(o);function n(e){return e+"px"}function s(e){const t=new Date(e);return!(t instanceof Date&&!isNaN(t))}function a(e){const t=this.el.style;t.left=n(e.x-1),t.top=n(e.y-1),t.width=n(e.width+52),t.height=n(e.height+2)}function l(e){const t=this.el.style;t.left=n(e.x-1),t.top=n(e.y-1),t.width=n(e.width+2),t.height=n(e.height+2)}function c(e){if(null===e)return;const t=new Date(e),i=("0"+t.getDate()).slice(-2),o=("0"+(t.getMonth()+1)).slice(-2);this.input.value="".concat(t.getFullYear(),"-").concat(o,"-").concat(i),this.input.addEventListener("keydown",v.bind(this))}function d(e){if(null===e)return;const t=new Date(e),i=("0"+t.getDate()).slice(-2),o=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getHours()).slice(-2),n=("0"+t.getMinutes()).slice(-2),s=("0"+t.getSeconds()).slice(-2);this.input.value="".concat(t.getFullYear(),"-").concat(o,"-").concat(i,"T").concat(r,":").concat(n,":").concat(s),this.input.addEventListener("keydown",v.bind(this))}function _(e){return this.input.addEventListener("keydown",v.bind(this)),this.input.addEventListener("mouseover",e=>{var t=document.createEvent("MouseEvents");t.initMouseEvent("mouseover",e.canBubble,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKye,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this._canvas.dispatchEvent(t)}),null===e?"":(this.input.value=this.localizer.format(e),e)}function u(e){return this._row.then(([t])=>{const i=t.__INDEX__;delete t.__INDEX__;const o=Object.keys(t)[0];this._table.update([{__INDEX__:i,[o]:e}])}),this.localizer.format(e)}function h(e){return this._row.then(([t])=>{const i=t.__INDEX__;delete t.__INDEX__;const o=Object.keys(t)[0];this._table.update([{__INDEX__:i,[o]:Number(e.replace(/,/g,""))}])}),this.localizer.format(e)}function g(e){return e=new Date(e),this._row.then(([t])=>{const i=t.__INDEX__;delete t.__INDEX__;const o=Object.keys(t)[0];this._table.update([{__INDEX__:i,[o]:e}])}),this.localizer.format(e)}function p(e){if(!(e&&e===this.initialValue)&&this.grid.fireBeforeCellEdit(this.event.gridCell,this.initialValue,e,this)){const t=this.event.gridCell.y+this.grid.renderer.dataWindow.top-1,i=this.event.gridCell.x;this._data[t][i]=e,this.grid.canvas.paintNow()}}function f(){}function v(e){e.stopPropagation();let t,i,o=this.grid,r=this.event.properties,n=r.feedbackCount,s=o.canvas.getKeyChar(e);return(t=this.specialKeyups[e.keyCode])&&(i=this[t](n))&&o.repaint(),r.mappedNavKey(s,e.ctrlKey)&&!t&&(i=this.stopEditing(n))&&o.repaint(),this.grid.fireSyntheticEditorKeyUpEvent(this,e),i}function m(e){var t=this.input.value;try{var i=this.validateEditorValue(t);if(!i)var o=this.getEditorValue(t)}catch(e){i=e}if(!i&&this.grid.fireSyntheticEditorDataChangeEvent(this,this.initialValue,o))try{this.saveEditorValue(o)}catch(e){i=e}if(i)e>=0?this.errorEffectBegin(++this.errors%e==0&&i):this.cancelEditing();else{const{x:e,y:t}=this.grid.selectionModel.getLastSelection().origin;this.grid.selectionModel.select(e,t+1,0,0),this.hideEditor(),this.grid.cellEditor=null,this.grid._is_editing=!0,this.el.remove(),this.grid._is_editing=!1,this.grid.div.parentNode.parentNode.host.focus()}return!i}function b(){return this.setEditorValue(this.initialValue),this.hideEditor(),this.grid.cellEditor=null,this.grid._is_editing=!0,this.el.remove(),this.grid._is_editing=!1,this.grid.takeFocus(),!0}function E(e){const t=r.a.extend("perspective-date",{localizer:e.localization.get("chromeDate"),template:"<input class='hypergrid-textfield' type='date'>",getEditorValue:g,setEditorValue:c,validateEditorValue:s,setBounds:a,selectAll:()=>{},saveEditorValue:p,keyup:f,stopEditing:m,cancelEditing:b}),i=r.a.extend("perspective-datetime",{localizer:e.localization.get("chromeDate"),template:"<input class='hypergrid-textfield' type='datetime-local'>",getEditorValue:g,setEditorValue:d,validateEditorValue:s,setBounds:a,selectAll:()=>{},saveEditorValue:p,keyup:f,stopEditing:m,cancelEditing:b}),o=r.a.extend("perspective-text",{setBounds:l,setEditorValue:_,getEditorValue:u,saveEditorValue:p,keyup:f,stopEditing:m,cancelEditing:b}),n=r.a.extend("perspective-number",{setBounds:l,setEditorValue:_,getEditorValue:h,validateEditorValue:e=>isNaN(Number(e.replace(/,/g,""))),saveEditorValue:p,keyup:f,stopEditing:m,cancelEditing:b});e.cellEditors.add(n),e.cellEditors.add(t),e.cellEditors.add(i),e.cellEditors.add(o)}},function(e,t,i){"use strict";function o(e,t){var i=t.bounds.x,o=t.bounds.y,r=t.bounds.width,n=t.bounds.height;if(t.minWidth=1,null===t.value)return;var s=t.value.rollup,a=t.value.isLeaf,l=t.value.rowPath.length-1,c=t.expanded,d=t.last,_=t.backgroundColor;t.isSelected&&(_=t.backgroundSelectionColor),t.isRowHovered&&t.hoverRowHighlight.enabled&&!t.isCellHovered?_=t.hoverRowHighlight.backgroundColor:t.isCellHovered&&t.hoverCellHighlight.enabled&&(_=t.hoverCellHighlight.backgroundColor),e.save(),e.cache.fillStyle=_,e.rect(i,o,r,n),e.fillRect(i,o,r,n);var u=t.gridLinesHColor;e.cache.strokeStyle=u,e.cache.fillStyle=u;var h=i;e.globalAlpha=.7,e.strokeStyle=u,e.beginPath();for(var g=1;g<=l;g++){h+=16;var p=d&&!c?n/2:n;e.moveTo(h,o),e.lineTo(h,o),e.lineTo(h,o+p),g===l?(e.moveTo(h,o+n/2),e.lineTo(h,o+n/2),e.lineTo(h+16-3,o+n/2)):e.lineTo(h,o+n)}a?e.lineTo(h+16+3,o+n/2):(e.moveTo(h+16+3,o+n/2),e.arc(h+16,o+n/2,3,0,2*Math.PI),t.isCellHovered&&(e.globalAlpha=1,e.fill(),e.globalAlpha=.7)),c&&!a&&(e.globalAlpha=.5,e.fill(),e.moveTo(h+16,o+n/2+3),e.lineTo(h+16,o+n),e.globalAlpha=.7),e.stroke(),e.closePath(),e.globalAlpha=1,e.fillStyle=t.isSelected?t.foregroundSelectionColor:t.color,e.textAlign="start",e.textBaseline="middle",e.font=t.isSelected?t.foregroundSelectionFont:t.treeHeaderFont;var f=h+16+6+3;let v=t.formatValue(s,t._type);t.minWidth=f+e.getTextWidth(v)+15;var m=e.getTextWidthTruncated(v,r-f+(i-3),!0),b=o+n/2;e.fillText(m.string?m.string:v,f,b),e.restore()}i.d(t,"a",(function(){return o}))},function(e,t,i){"use strict";i.r(t),function(e){i(4),i(29),i(30),i(12);var t=i(14),o=i.n(t),r=i(15),n=i.n(r),s=i(1),a=i.n(s),l=i(16),c=i.n(l),d=i(17),_=i(19),u=i(5),h=i(21),g=i(22),p=i.n(g),f=i(23),v=i.n(f),m=i(0),b=i(24),E=i(25),w=i(26);function y(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(y.prototype,HTMLElement.prototype),Object.setPrototypeOf(y,HTMLElement),a.a.prototype.stopResizeLoop(),a.a.prototype.stopPaintLoop(),Object(h.bindTemplate)(p.a,v.a)(class extends y{set_data(e,t,i,o,r,n=!1){const s=Object(u.psp2hypergrid)(e,t,i,o,r);this.grid?this.grid.behavior.setPSP(s,n):this._hg_data=s}connectedCallback(){if(!this.grid){const e=this.shadowRoot.querySelector("#mainGrid");e.setAttribute("hidden",!0),a.a.prototype.restartPaintLoop(),this.grid=new o.a(e,{DataModel:_.a}),a.a.prototype.stopPaintLoop(),e.removeAttribute("hidden"),this.grid.get_styles=()=>Object(m.d)(this),this.grid.get_dynamic_styles=(...e)=>Object(m.c)(this,...e);const t=Object(m.b)(),i=Object(m.d)(this);t.renderer=["SimpleCell","Borders"],Object.assign(t.groupedHeader,i[""].groupedHeader),"number"==typeof t.groupedHeader.flatHeight&&(t.groupedHeader.flatHeight=t.groupedHeader.flatHeight.toString()),this.grid.installPlugins([d,[c.a,t.groupedHeader]]);let r=this.grid.cellRenderers.items.GroupedHeader.paint;this.grid.cellRenderers.items.GroupedHeader.paint=function(e,t){return this.visibleColumns=t.grid.renderer.visibleColumns,r.call(this,e,t)},this.grid.addProperties(t),this.grid.addProperties(i[""]),Object(b.a)(this.grid),Object(E.a)(this.grid),this.grid.cellRenderers.add("TreeCell",n.a.extend({paint:w.a})),this._hg_data&&(this.grid.behavior.setPSP(this._hg_data),delete this._hgdata)}}});const x=Symbol("Hypergrid private");function C(){return this[x]?this[x].grid:void 0}async function A(e){let t;return C.call(this)?t=this[x]:(t=this[x]=document.createElement("perspective-hypergrid"),t.setAttribute("tabindex",1),t.addEventListener("blur",()=>{t.grid&&!t.grid._is_editing&&(t.grid.selectionModel.clear(!0),t.grid.paintNow())})),t.isConnected||(e.innerHTML="",e.appendChild(t),await new Promise(e=>setTimeout(e)),t.grid.canvas.resize(!1,!0)),t}function O(e,t){const i=e.divCanvas;e.divCanvas=void 0,t(),e.divCanvas=i}e.registerPlugin("hypergrid",{name:"Grid",create:async function(e,t,i,o,r,n){let s=C.call(this);s&&(s.behavior.dataModel._view=void 0,s.behavior.dataModel._table=void 0,O(s,()=>s.allowEvents(!1)));const a=await t.get_config();if(i.cancelled)return;const l=a.column_pivots,c=a.row_pivots,d={start_row:0,end_row:1,id:0===c.length&&0===l.length},[_,u,h,g,p]=await Promise.all([t.num_rows(),t.to_columns(d),t.schema(),this._table.schema(),t.column_paths()]);if(i.cancelled)return;let f=await A.call(this,e);if(s=C.call(this),i.cancelled)return;const v=p.filter(e=>"__INDEX__"!==e),m=s.behavior.dataModel;m._grid=s,m.setIsTree(c.length>0),m.setDirty(_),m.clearSelectionState(),m._view=t,m._table=this._table,m._config=a,m._viewer=this,m._columns=v,m._pad_window=this.hasAttribute("settings"),s.renderer.needsComputeCellsBounds=!0,O(s,()=>f.set_data(u,h,g,c,v,n)),s.behavior.dataModel._outstanding&&await s.behavior.dataModel._outstanding.req,await s.canvas.resize(!0),s.allowEvents(!0)},selectMode:"toggle",update:async function(e,t,i){const o=await t.num_rows();if(i.cancelled)return;const r=C.call(this);if(!r)return;const n=r.behavior.dataModel;n._view=t,n._table=this._table,n.setDirty(o),r.behaviorChanged(),r.canvas.paintNow()},deselectMode:"pivots",styleElement:function(){if(this[x]){const e=this[x];Object(m.a)(e);const t=Object(m.d)(e);e.grid&&e.grid.addProperties(t[""]),e.grid.behavior.createColumns(),e.grid.canvas.paintNow()}},resize:async function(){const e=C.call(this);if(e){e.canvas.checksize(),e.canvas.paintNow();let t=await this._view.num_rows();e.behavior.dataModel.setDirty(t),await e.canvas.resize(!0),e.canvas.paintNow()}},delete:function(){const e=C.call(this);e&&(e.terminate(),e.div=void 0,e.canvas.div=void 0,e.canvas.canvas=void 0,e.sbVScroller=void 0,e.sbHScroller=void 0,delete this[x])}})}.call(this,i(28))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__29__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__30__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__31__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__32__},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var r=(s=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),n=o.sources.map((function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"}));return[i].concat(n).concat([r]).join("\n")}var s;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var n=this[r][0];"number"==typeof n&&(o[n]=!0)}for(r=0;r<e.length;r++){var s=e[r];"number"==typeof s[0]&&o[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),t.push(s))}},t}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__34__}])}));
//# sourceMappingURL=perspective-viewer-hypergrid.js.map